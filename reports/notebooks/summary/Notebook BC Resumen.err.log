Traceback (most recent call last):
  File "C:\Users\jmcajigas\.conda\envs\bancolombia\lib\site-packages\jupyter_cache\executors\utils.py", line 58, in single_nb_execution
    executenb(
  File "C:\Users\jmcajigas\.conda\envs\bancolombia\lib\site-packages\nbclient\client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "C:\Users\jmcajigas\.conda\envs\bancolombia\lib\site-packages\nbclient\util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "C:\Users\jmcajigas\.conda\envs\bancolombia\lib\site-packages\nbclient\util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "C:\Users\jmcajigas\.conda\envs\bancolombia\lib\asyncio\base_events.py", line 647, in run_until_complete
    return future.result()
  File "C:\Users\jmcajigas\.conda\envs\bancolombia\lib\site-packages\nbclient\client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "C:\Users\jmcajigas\.conda\envs\bancolombia\lib\site-packages\nbclient\client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "C:\Users\jmcajigas\.conda\envs\bancolombia\lib\site-packages\nbclient\client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
df = pd.read_pickle(r"C:\DigitalizaciÃ³n\Fase 2\Informe_Mensual_fase2\data\data_weekly_report.pkl")

# Legacy code (including the library) expects these column names
# but the new Ubidots library returns more specific column names
# so renaming is necessary. TODO: rework the Report library
# so that it uses these more descriptive column names.
df = df.rename(columns={'variable_label':'variable','device_label':'device',})

df = df.sort_values(by=['variable','datetime'])
df = pro.datetime_attributes(df)

# Agrego esta linea codigo para quitar estas dos sedes que generar ruido por datos altos
#df = df[~df["device_name"].isin(["BC 829 - Unicentro Cali", "BC 454 - Quinta Avenida 2"])]

df_bl, df_st = pro.split_into_baseline_and_study(df, baseline=cfg.BASELINE, study=cfg.STUDY, inclusive='left')

study_daterange = pd.Series(pd.date_range(start=cfg.STUDY[0], end=cfg.STUDY[1], freq='D'))

------------------

[1;31m---------------------------------------------------------------------------[0m
[1;31mMemoryError[0m                               Traceback (most recent call last)
Cell [1;32mIn[3], line 15[0m
[0;32m     10[0m df [38;5;241m=[39m pro[38;5;241m.[39mdatetime_attributes(df)
[0;32m     12[0m [38;5;66;03m# Agrego esta linea codigo para quitar estas dos sedes que generar ruido por datos altos[39;00m
[0;32m     13[0m [38;5;66;03m#df = df[~df["device_name"].isin(["BC 829 - Unicentro Cali", "BC 454 - Quinta Avenida 2"])][39;00m
[1;32m---> 15[0m df_bl, df_st [38;5;241m=[39m [43mpro[49m[38;5;241;43m.[39;49m[43msplit_into_baseline_and_study[49m[43m([49m[43mdf[49m[43m,[49m[43m [49m[43mbaseline[49m[38;5;241;43m=[39;49m[43mcfg[49m[38;5;241;43m.[39;49m[43mBASELINE[49m[43m,[49m[43m [49m[43mstudy[49m[38;5;241;43m=[39;49m[43mcfg[49m[38;5;241;43m.[39;49m[43mSTUDY[49m[43m,[49m[43m [49m[43minclusive[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43mleft[39;49m[38;5;124;43m'[39;49m[43m)[49m
[0;32m     17[0m study_daterange [38;5;241m=[39m pd[38;5;241m.[39mSeries(pd[38;5;241m.[39mdate_range(start[38;5;241m=[39mcfg[38;5;241m.[39mSTUDY[[38;5;241m0[39m], end[38;5;241m=[39mcfg[38;5;241m.[39mSTUDY[[38;5;241m1[39m], freq[38;5;241m=[39m[38;5;124m'[39m[38;5;124mD[39m[38;5;124m'[39m))

File [1;32mC:\DigitalizaciÃ³n\Fase 2\Informe_Mensual_fase2\library_report_v2.py:361[0m, in [0;36mProcessing.split_into_baseline_and_study[1;34m(df, baseline, study, inclusive)[0m
[0;32m    359[0m is_baseline_range [38;5;241m=[39m df[38;5;241m.[39mindex[38;5;241m.[39mto_series()[38;5;241m.[39mbetween(baseline[[38;5;241m0[39m], baseline[[38;5;241m1[39m], inclusive[38;5;241m=[39minclusive)
[0;32m    360[0m is_study_range [38;5;241m=[39m df[38;5;241m.[39mindex[38;5;241m.[39mto_series()[38;5;241m.[39mbetween(study[[38;5;241m0[39m], study[[38;5;241m1[39m], inclusive[38;5;241m=[39minclusive)
[1;32m--> 361[0m [38;5;28;01mreturn[39;00m ([43mdf[49m[43m[[49m[43mis_baseline_range[49m[43m][49m, df[is_study_range])

File [1;32m~\.conda\envs\bancolombia\lib\site-packages\pandas\core\frame.py:3798[0m, in [0;36mDataFrame.__getitem__[1;34m(self, key)[0m
[0;32m   3796[0m [38;5;66;03m# Do we have a (boolean) 1d indexer?[39;00m
[0;32m   3797[0m [38;5;28;01mif[39;00m com[38;5;241m.[39mis_bool_indexer(key):
[1;32m-> 3798[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_getitem_bool_array[49m[43m([49m[43mkey[49m[43m)[49m
[0;32m   3800[0m [38;5;66;03m# We are left with two options: a single key, and a collection of keys,[39;00m
[0;32m   3801[0m [38;5;66;03m# We interpret tuples as collections only for non-MultiIndex[39;00m
[0;32m   3802[0m is_single_key [38;5;241m=[39m [38;5;28misinstance[39m(key, [38;5;28mtuple[39m) [38;5;129;01mor[39;00m [38;5;129;01mnot[39;00m is_list_like(key)

File [1;32m~\.conda\envs\bancolombia\lib\site-packages\pandas\core\frame.py:3853[0m, in [0;36mDataFrame._getitem_bool_array[1;34m(self, key)[0m
[0;32m   3851[0m key [38;5;241m=[39m check_bool_indexer([38;5;28mself[39m[38;5;241m.[39mindex, key)
[0;32m   3852[0m indexer [38;5;241m=[39m key[38;5;241m.[39mnonzero()[[38;5;241m0[39m]
[1;32m-> 3853[0m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_take_with_is_copy[49m[43m([49m[43mindexer[49m[43m,[49m[43m [49m[43maxis[49m[38;5;241;43m=[39;49m[38;5;241;43m0[39;49m[43m)[49m

File [1;32m~\.conda\envs\bancolombia\lib\site-packages\pandas\core\generic.py:3902[0m, in [0;36mNDFrame._take_with_is_copy[1;34m(self, indices, axis)[0m
[0;32m   3894[0m [38;5;28;01mdef[39;00m [38;5;21m_take_with_is_copy[39m([38;5;28mself[39m: NDFrameT, indices, axis[38;5;241m=[39m[38;5;241m0[39m) [38;5;241m-[39m[38;5;241m>[39m NDFrameT:
[0;32m   3895[0m [38;5;250m    [39m[38;5;124;03m"""[39;00m
[0;32m   3896[0m [38;5;124;03m    Internal version of the `take` method that sets the `_is_copy`[39;00m
[0;32m   3897[0m [38;5;124;03m    attribute to keep track of the parent dataframe (using in indexing[39;00m
[1;32m   (...)[0m
[0;32m   3900[0m [38;5;124;03m    See the docstring of `take` for full explanation of the parameters.[39;00m
[0;32m   3901[0m [38;5;124;03m    """[39;00m
[1;32m-> 3902[0m     result [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_take[49m[43m([49m[43mindices[49m[38;5;241;43m=[39;49m[43mindices[49m[43m,[49m[43m [49m[43maxis[49m[38;5;241;43m=[39;49m[43maxis[49m[43m)[49m
[0;32m   3903[0m     [38;5;66;03m# Maybe set copy if we didn't actually change the index.[39;00m
[0;32m   3904[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m result[38;5;241m.[39m_get_axis(axis)[38;5;241m.[39mequals([38;5;28mself[39m[38;5;241m.[39m_get_axis(axis)):

File [1;32m~\.conda\envs\bancolombia\lib\site-packages\pandas\core\generic.py:3884[0m, in [0;36mNDFrame._take[1;34m(self, indices, axis, convert_indices)[0m
[0;32m   3873[0m [38;5;28;01mdef[39;00m [38;5;21m_take[39m(
[0;32m   3874[0m     [38;5;28mself[39m: NDFrameT,
[0;32m   3875[0m     indices,
[0;32m   3876[0m     axis[38;5;241m=[39m[38;5;241m0[39m,
[0;32m   3877[0m     convert_indices: bool_t [38;5;241m=[39m [38;5;28;01mTrue[39;00m,
[0;32m   3878[0m ) [38;5;241m-[39m[38;5;241m>[39m NDFrameT:
[0;32m   3879[0m [38;5;250m    [39m[38;5;124;03m"""[39;00m
[0;32m   3880[0m [38;5;124;03m    Internal version of the `take` allowing specification of additional args.[39;00m
[0;32m   3881[0m 
[0;32m   3882[0m [38;5;124;03m    See the docstring of `take` for full explanation of the parameters.[39;00m
[0;32m   3883[0m [38;5;124;03m    """[39;00m
[1;32m-> 3884[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_consolidate_inplace[49m[43m([49m[43m)[49m
[0;32m   3886[0m     new_data [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_mgr[38;5;241m.[39mtake(
[0;32m   3887[0m         indices,
[0;32m   3888[0m         axis[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39m_get_block_manager_axis(axis),
[0;32m   3889[0m         verify[38;5;241m=[39m[38;5;28;01mTrue[39;00m,
[0;32m   3890[0m         convert_indices[38;5;241m=[39mconvert_indices,
[0;32m   3891[0m     )
[0;32m   3892[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_constructor(new_data)[38;5;241m.[39m__finalize__([38;5;28mself[39m, method[38;5;241m=[39m[38;5;124m"[39m[38;5;124mtake[39m[38;5;124m"[39m)

File [1;32m~\.conda\envs\bancolombia\lib\site-packages\pandas\core\generic.py:5980[0m, in [0;36mNDFrame._consolidate_inplace[1;34m(self)[0m
[0;32m   5977[0m [38;5;28;01mdef[39;00m [38;5;21mf[39m():
[0;32m   5978[0m     [38;5;28mself[39m[38;5;241m.[39m_mgr [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_mgr[38;5;241m.[39mconsolidate()
[1;32m-> 5980[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_protect_consolidate[49m[43m([49m[43mf[49m[43m)[49m

File [1;32m~\.conda\envs\bancolombia\lib\site-packages\pandas\core\generic.py:5968[0m, in [0;36mNDFrame._protect_consolidate[1;34m(self, f)[0m
[0;32m   5966[0m     [38;5;28;01mreturn[39;00m f()
[0;32m   5967[0m blocks_before [38;5;241m=[39m [38;5;28mlen[39m([38;5;28mself[39m[38;5;241m.[39m_mgr[38;5;241m.[39mblocks)
[1;32m-> 5968[0m result [38;5;241m=[39m [43mf[49m[43m([49m[43m)[49m
[0;32m   5969[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m([38;5;28mself[39m[38;5;241m.[39m_mgr[38;5;241m.[39mblocks) [38;5;241m!=[39m blocks_before:
[0;32m   5970[0m     [38;5;28mself[39m[38;5;241m.[39m_clear_item_cache()

File [1;32m~\.conda\envs\bancolombia\lib\site-packages\pandas\core\generic.py:5978[0m, in [0;36mNDFrame._consolidate_inplace.<locals>.f[1;34m()[0m
[0;32m   5977[0m [38;5;28;01mdef[39;00m [38;5;21mf[39m():
[1;32m-> 5978[0m     [38;5;28mself[39m[38;5;241m.[39m_mgr [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_mgr[49m[38;5;241;43m.[39;49m[43mconsolidate[49m[43m([49m[43m)[49m

File [1;32m~\.conda\envs\bancolombia\lib\site-packages\pandas\core\internals\managers.py:686[0m, in [0;36mBaseBlockManager.consolidate[1;34m(self)[0m
[0;32m    684[0m bm [38;5;241m=[39m [38;5;28mtype[39m([38;5;28mself[39m)([38;5;28mself[39m[38;5;241m.[39mblocks, [38;5;28mself[39m[38;5;241m.[39maxes, [38;5;28mself[39m[38;5;241m.[39mrefs, verify_integrity[38;5;241m=[39m[38;5;28;01mFalse[39;00m)
[0;32m    685[0m bm[38;5;241m.[39m_is_consolidated [38;5;241m=[39m [38;5;28;01mFalse[39;00m
[1;32m--> 686[0m [43mbm[49m[38;5;241;43m.[39;49m[43m_consolidate_inplace[49m[43m([49m[43m)[49m
[0;32m    687[0m [38;5;28;01mreturn[39;00m bm

File [1;32m~\.conda\envs\bancolombia\lib\site-packages\pandas\core\internals\managers.py:1871[0m, in [0;36mBlockManager._consolidate_inplace[1;34m(self)[0m
[0;32m   1869[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m [38;5;28mself[39m[38;5;241m.[39mis_consolidated():
[0;32m   1870[0m     [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mrefs [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[1;32m-> 1871[0m         [38;5;28mself[39m[38;5;241m.[39mblocks [38;5;241m=[39m [43m_consolidate[49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mblocks[49m[43m)[49m
[0;32m   1872[0m     [38;5;28;01melse[39;00m:
[0;32m   1873[0m         [38;5;28mself[39m[38;5;241m.[39mblocks, [38;5;28mself[39m[38;5;241m.[39mrefs [38;5;241m=[39m _consolidate_with_refs([38;5;28mself[39m[38;5;241m.[39mblocks, [38;5;28mself[39m[38;5;241m.[39mrefs)

File [1;32m~\.conda\envs\bancolombia\lib\site-packages\pandas\core\internals\managers.py:2329[0m, in [0;36m_consolidate[1;34m(blocks)[0m
[0;32m   2327[0m new_blocks: [38;5;28mlist[39m[Block] [38;5;241m=[39m []
[0;32m   2328[0m [38;5;28;01mfor[39;00m (_can_consolidate, dtype), group_blocks [38;5;129;01min[39;00m grouper:
[1;32m-> 2329[0m     merged_blocks, _ [38;5;241m=[39m [43m_merge_blocks[49m[43m([49m
[0;32m   2330[0m [43m        [49m[38;5;28;43mlist[39;49m[43m([49m[43mgroup_blocks[49m[43m)[49m[43m,[49m[43m [49m[43mdtype[49m[38;5;241;43m=[39;49m[43mdtype[49m[43m,[49m[43m [49m[43mcan_consolidate[49m[38;5;241;43m=[39;49m[43m_can_consolidate[49m
[0;32m   2331[0m [43m    [49m[43m)[49m
[0;32m   2332[0m     new_blocks [38;5;241m=[39m extend_blocks(merged_blocks, new_blocks)
[0;32m   2333[0m [38;5;28;01mreturn[39;00m [38;5;28mtuple[39m(new_blocks)

File [1;32m~\.conda\envs\bancolombia\lib\site-packages\pandas\core\internals\managers.py:2388[0m, in [0;36m_merge_blocks[1;34m(blocks, dtype, can_consolidate)[0m
[0;32m   2385[0m     new_values [38;5;241m=[39m bvals2[[38;5;241m0[39m][38;5;241m.[39m_concat_same_type(bvals2, axis[38;5;241m=[39m[38;5;241m0[39m)
[0;32m   2387[0m argsort [38;5;241m=[39m np[38;5;241m.[39margsort(new_mgr_locs)
[1;32m-> 2388[0m new_values [38;5;241m=[39m [43mnew_values[49m[43m[[49m[43margsort[49m[43m][49m
[0;32m   2389[0m new_mgr_locs [38;5;241m=[39m new_mgr_locs[argsort]
[0;32m   2391[0m bp [38;5;241m=[39m BlockPlacement(new_mgr_locs)

[1;31mMemoryError[0m: Unable to allocate 589. MiB for an array with shape (4, 19302249) and data type object
MemoryError: Unable to allocate 589. MiB for an array with shape (4, 19302249) and data type object

